swagger: '2.0'
info:
  version: "v1"
  title: "WSO2 Identity Server User Account Recovery Rest API"
  description: |
    This is the RESTful API for username and password recovery initated by the user.

    It is written with [swagger 2](http://swagger.io/).

  contact:
    name: "WSO2"
    url: "http://wso2.com/products/identity-server/"
    email: "architecture@wso2.org"
  license:
    name: "Apache 2.0"
    url: "http://www.apache.org/licenses/LICENSE-2.0.html"

######################################################
# The fixed parts of the URLs of the API
######################################################

# The schemes supported by the API
schemes:
  - https

# The domain of the API.
# This is configured by the customer during deployment.
# The given host is just an example.
host: localhost

# The base path of the API.
# Will be prefixed to all paths.
# If the tenant domain is carbon.super basepath can be /api/users/v1
# Example: /t/{tenant-domain}/api/users/v1
basePath: /api/users/v1

# The following media types can be passed as input in message bodies of the API.
# The actual media type must be specified in the Content-Type header field of the request.
# The default is json, i.e. the Content-Type header is not needed to
# be set, but supporting it serves extensibility.
consumes:
  - application/json

# The following media types may be passed as output in message bodies of the API.
# The media type(s) consumable by the requester is specified in the Accept Header field
# of the corresponding request.
# The actual media type returned will be specified in the Content-Type header field
# of the of the response.
# The default of the Accept header is json, i.e. there is not needed to
# set the value, but supporting it serves extensibility.
produces:
  - application/json
paths:

  /recovery/username/init:
    post:
      tags:
        - Username Recovery
      summary: Initiate Username Recovery
      operationId: initiateUsernameRecovery
      description: |
        - This API is used to initiate username recovery by user. The API will return available recovery information for username recovery with notifications.
        - Use the returned __recoveryCode__ and the __channelId__ with __username recover api__ to confirm the the username recovery and to recieve recovery notifications via the channel specified by the user.

      # API Parameters:
      parameters:
        -
          name: Init Request
          in: body
          description: Request to initate username recovery process. The request should contain the claims to identify the user. User claims are `REQUIRED`.
          required: true
          schema:
            $ref: '#/definitions/InitRequest'

      # API Responses
      responses:
        200:
          description: User is successfully identified for the given claims and returning available notification channels for the user.
          schema:
            type: array
            items:
              $ref: '#/definitions/AccountRecoveryType'
          examples:
            application/json:
              [{
                 "mode": "recoverWithNotifications",
                 "channelInfo": {

                   "recoveryCode": "1234-55678-5668-2345",
                   "channels": [
                   {
                     "id": 1,
                     "type": "EMAIL",
                     "value": "wso2***********.com",
                     "preferred": true
                   },
                   {
                     "id": 2,
                     "type": "SMS",
                     "value": "**********123",
                     "preferred": false
                   }
                   ]
                 },
                 "links": [
                 {
                   "rel": "next",
                   "href": "/api/identity/recovery/v1/recovery",
                   "type": "POST"
                 }
                 ]

               }
              ]
        400:
          description: Bad Request. The request cannot be processed by the server.
          schema:
            $ref: '#/definitions/ErrorResponse'
          examples:
            application/json:
              {
                "code": "UAR-10001",
                "message": "bad_request",
                "description": "bad request",
                "traceId": "23456fghj678vb78"
              }
        403:
          description: Username recovery is not enabled.
          schema:
            $ref: '#/definitions/ErrorResponse'
          examples:
            application/json:
              {
                "code": "UNR-10003",
                "message": "Forbidden",
                "description": "Username recovery is not enabled",
                "traceId": "23456fghj678vb78"
              }
        404:
          description: No user found for the given set of claims or no recovery channels are availabe for the user.
          schema:
            $ref: '#/definitions/ErrorResponse'
          examples:
            application/json:
              {
                "code": "UAR-10002",
                "message": "Not found",
                "description": "No user found",
                "traceId": "23456fghj678vb78"
              }
        409:
          description: Mutiple users found for the given claims.
          schema:
            $ref: '#/definitions/ErrorResponse'
          examples:
            application/json:
              {
                "code": "UAR-10008",
                "message": "Conflict",
                "description": "Multiple users found for given claims",
                "traceId": "23456fghj678vb78"
              }
        500:
          description: Server Error.
          schema:
            $ref: '#/definitions/ErrorResponse'
          examples:
            application/json:
              {
                "code": "UNR-15001",
                "message": "Internal Error",
                "description": "Internal Error",
                "traceId": "23456fghj678vb78"
              }

  /recovery/username/recover:
    post:
      tags:
        - Username Recovery
      summary: Get Recovery Information
      operationId: recoverUsername
      description: |
        - This API is used to confirm username recovery and send username recovery information to the user who matches the recovery code via the channel specified by the channel Id.
         - __NOTE__: If the notification channel is __EXTERNAL__, the API will return the username of the user.

      # API Parameters:
      parameters:
        -
          name: RecoveryRequest
          in: body
          description: |
            - Request to confirm username recovery and receive recovery notifications.
            - `recoveryCode` and `channelId` are `REQUIRED`.
            - __NOTE__ `channelId` should always be __larger than 0__.
          required: true
          schema:
            $ref: '#/definitions/RecoveryRequest'

      # API Responses
      responses:
        200:
          description: Username is successfully recovered and the __notification channel__ is `EXTERNAL`.
          schema:
            $ref: '#/definitions/UsernameRecoveryExternalNotifyResponse'
          examples:
            application/json:
              {
                "code": "UNR-02002",
                "message": "Username recovery information sent externally",
                "notificationChannel": "EXTERNAL",
                "username": "PRIMARY/sominda1@carbon.super"
              }
        202:
          description: Username is successfully recovered.
          schema:
            $ref: '#/definitions/UsernameRecoveryInternalNotifyResponse'
          examples:
            application/json:
              {
                "code": "UNR-02001",
                "message": "Username recovery information sent via user preferred notification channel",
                "notificationChannel": "EMAIL",
              }
        400:
          description: Bad Request. Request cannot be processed by the server.
          schema:
            $ref: '#/definitions/ErrorResponse'
          examples:
            application/json:
              {
                "code": "UNR-10001",
                "message": "bad_request",
                "description": "bad request",
                "traceId": "23456fghj678vb78"
              }
        404:
          description: Recovery code is not found.
          schema:
            $ref: '#/definitions/ErrorResponse'
          examples:
            application/json:
              {
                "code": "UNR-10001",
                "message": "not_found",
                "description": "recovery code not found",
                "traceId": "23456fghj678vb78"
              }
        406:
          description: |
            - Recovery code given in the request is not valid or expired.
            - Channel id is not valid
          schema:
            $ref: '#/definitions/ErrorResponse'
          examples:
            application/json:
              {
                "code": "UNR-10001",
                "message": "not acceptable",
                "description": "invalid error code : 1234-2345-12345-123456",
                "traceId": "23456fghj678vb78"
              }
        500:
          description: Server Error.
          schema:
            $ref: '#/definitions/ErrorResponse'
          examples:
            application/json:
              {
                "code": "UNR-15001",
                "message": "Internal Error",
                "description": "Internal Error",
                "traceId": "23456fghj678vb78"
              }

  /recovery/password/init:
    post:
      tags:
        - Password Recovery
      summary: |
        Initiate password recovery
      operationId: initiatePasswordRecovery
      description: |
        - This API is used to initiate password recovery by user. The API will return recovery information for password recovery with challenge questions and password recovery with notifications.
        - `mode` __recoverWithNotifications__ contains available communication channels and a recovery code for password recovery with notifications. The next API call will be returned in the response.
        - If `password recovery with notifications` is not enabled, the response will not contain __recoverWithNotifications__ mode.
        - __recoverWithChallengeQuestions__ contains the next API call to begin the recovery process via challenge questions.
        - If `password recovery with challenge questions` is not enabled, the response will not contain __recoverWithChallengeQuestions__ mode.

      # API Parameters:
      parameters:
        -
          name: InitRequest
          in: body
          description: Request to initate password recovery process. The request should contain the claims to identify the user. User claims are `REQUIRED`.
          required: true
          schema:
            $ref: '#/definitions/InitRequest'

      # API Responses
      responses:
        200:
          description: User is successfully identified for the given claims and returning available notification channels for the user.
          schema:
            type: array
            items:
              $ref: '#/definitions/AccountRecoveryType'
          examples:
            application/json:
              [{
                 "mode": "recoverWithNotifications",
                 "channelInfo": {

                   "recoveryCode": "1234-55678-5668-2345",
                   "channels": [
                   {
                     "id": 1,
                     "type": "EMAIL",
                     "value": "wso2***********.com",
                     "preferred": false
                   },
                   {
                     "id": 2,
                     "type": "SMS",
                     "value": "**********123",
                     "preferred": true
                   }
                   ]
                 },
                 "links": [
                 {
                   "rel": "next",
                   "href": "/api/identity/recovery/v1/recovery",
                   "type": "POST"
                 }
                 ]

               },
               {
                 "mode": "recoverWithChallengeQuestions",
                 "links": [
                 {
                   "rel": "next",
                   "href": "/t/carbon.super/api/identity/recovery/v0.9/security-question?username=sominda",
                   "type": "GET"
                 }
                 ]

               }
              ]

        400:
          description: Bad Request. The request cannot be processed by the server.
          schema:
            $ref: '#/definitions/ErrorResponse'
          examples:
            application/json:
              {
                "code": "UAR-10001",
                "message": "bad_request",
                "description": "bad request",
                "traceId": "23456fghj678vb78"
              }
        404:
          description: No user found for the given set of claims or no recovery channels are availabe for the user.
          schema:
            $ref: '#/definitions/ErrorResponse'
          examples:
            application/json:
              {
                "code": "UAR-10002",
                "message": "Not found",
                "description": "No user found",
                "traceId": "23456fghj678vb78"
              }
        409:
          description: Mutiple users found for the given claims.
          schema:
            $ref: '#/definitions/ErrorResponse'
          examples:
            application/json:
              {
                "code": "UAR-10008",
                "message": "Conflict",
                "description": "Multiple users found for given claims",
                "traceId": "23456fghj678vb78"
              }
        500:
          description: Server Error.
          schema:
            $ref: '#/definitions/ErrorResponse'
          examples:
            application/json:
              {
                "code": "UAR-15001",
                "message": "Internal Error",
                "description": "Internal Error",
                "traceId": "23456fghj678vb78"
              }

  /recovery/password/recover:
    post:
      tags:
        - Password Recovery
      summary: |
        Get Recovery Information
      operationId: recoverPassword
      description: |
        - This API is used to send recovery information to the user who matches the recovery code via the channel specified by the channel Id.
        - NOTE: If the notification channel is EXTERNAL, the API will return a confirmationCode.
        - Use the returned confimation code with __password recpvery confirm API__ to verify the password recovery process.
        - The API will return the next API call.

      # API Parameters:
      parameters:
        -
          name: RecoveryRequest
          in: body
          description: |
            - Request to receive recovery notifications.
            - `recoveryCode` and `channelId` are `REQUIRED`.
            - __NOTE__ `channelId` should always be __larger than 0__.
          required: true
          schema:
            $ref: '#/definitions/RecoveryRequest'

      # API Responses
      responses:
        200:
          description:  |
            - Password recovery initiated via `EXTERNAL` channel. API will return a  `confirmationCode` to confirm password recovery.
            - Use the confirmation code with __password recpvery confirm API__ to confirm the password recovery.
          schema:
            $ref: '#/definitions/PasswordRecoveryExternalNotifyResponse'
          examples:
            application/json:
              {
                "code": "PWR-02002",
                "message": "Password recovery information sent externally",
                "notificationChannel": "EXTERNAL",
                "confirmationCode": "12345-45678-6789098-8765",
                "links": [
                {
                  "rel": "next",
                  "href": "api/identity/recovery/v1/password/confirm",
                  "type": "POST"
                }
                ]
              }
        202:
          description: |
            - Password recovery initiated via internal channels. API will send a `confirmationCode` to the channel specified by the user.
            - Use the confirmation code with __password recovery confirm API__ to confirm the password recovery.
          schema:
            $ref: '#/definitions/PasswordRecoveryInternalNotifyResponse'
          examples:
            application/json:
              {
                "code": "PWR-02002",
                "message": "Password recovery information sent externally",
                "notificationChannel": "EXTERNAL",
                "resendCode": "12345-45678-6789098-8765",
                "links": [
                {
                  "rel": "next",
                  "href": "api/identity/recovery/v1/password/confirm",
                  "type": "POST"
                },
                {
                  "rel": "resend",
                  "href": "api/identity/recovery/v1/password/resend",
                  "type": "POST"
                }
                ]
              }
        400:
          description: Bad Request. Request cannot be processed by the server.
          schema:
            $ref: '#/definitions/ErrorResponse'
          examples:
            application/json:
              {
                "code": "PWR-10001",
                "message": "bad_request",
                "description": "bad request",
                "traceId": "23456fghj678vb78"
              }
        403:
          description: Password recovery is not enabled.
          schema:
            $ref: '#/definitions/ErrorResponse'
          examples:
            application/json:
              {
                "code": "PWR-10004",
                "message": "Forbidden",
                "description": "Password recovery is not enabled",
                "traceId": "23456fghj678vb78"
              }
        404:
          description: Recovery code is not found.
          schema:
            $ref: '#/definitions/ErrorResponse'
          examples:
            application/json:
              {
                "code": "PWR-10001",
                "message": "not_found",
                "description": "recovery code not found",
                "traceId": "23456fghj678vb78"
              }
        406:
          description: |
            - Recovery code given in the request is not valid or expired.
            - Channel id is not valid
          schema:
            $ref: '#/definitions/ErrorResponse'
          examples:
            application/json:
              {
                "code": "PWR-10003",
                "message": "not acceptable",
                "description": "invalid error code : 1234-2345-12345-123456",
                "traceId": "23456fghj678vb78"

              }
        500:
          description: Server Error.
          schema:
            $ref: '#/definitions/ErrorResponse'
          examples:
            application/json:
              {
                "code": "PWR-15001",
                "message": "Internal Error",
                "description": "Internal Error",
                "traceId": "23456fghj678vb78"
              }

  /recovery/password/resend:
    post:
      tags:
        - Password Recovery
      summary: |
        Resend password recovery confirmation details
      operationId: resendConfirmation
      description: |
        - This API is used to resend a confirmation code to the user via a user preferred channel defined at password recovery.
        - NOTE: The API cannot be used when the notification channel is external.
        - The API will return the next API calls.

      # API Parameters:
      parameters:
        -
          name: ResendConfirmationRequest
          in: body
          description: |
            - Request to resend the `confirmationCode` to the user via a user preferred channel.
            - Can send additional properties.
          required: true
          schema:
            $ref: '#/definitions/ResendConfirmationRequest'

      # API Responses
      responses:
        202:
          description: |
            - API will send a `confirmationCode` to the channel specified by the user.
            - Use the confirmation code with __password recpvery confirm API__ to confirm the password recovery.
          schema:
            $ref: '#/definitions/ResendConfirmationCodeResponse'
          examples:
            application/json:
              {
                "code": "PWR-02002",
                "message": "successful_request",
                "notificationChannel": "EMAIL",
                "resendCode": "1234-12345-234-123456",
                "links": [
                {
                  "rel": "next",
                  "href": "/api/identity/recovery/v1/recovery",
                  "type": "POST"
                },
                {
                  "rel": "resend",
                  "href": "api/identity/recovery/v1/password/resend",
                  "type": "POST"
                }
                ]
              }
        400:
          description: Bad Request. Request cannot be processed by the server.
          schema:
            $ref: '#/definitions/ErrorResponse'
          examples:
            application/json:
              {
                "code": "UAR-10001",
                "message": "bad_request",
                "description": "bad request",
                "traceId": "23456fghj678vb78"
              }
        404:
          description: Resend code is not found.
          schema:
            $ref: '#/definitions/ErrorResponse'
          examples:
            application/json:
              {
                "code": "UAR-10001",
                "message": "not_found",
                "description": "recovery code not found",
                "traceId": "23456fghj678vb78"
              }
        406:
          description: Resend code given in the request is not valid or expired.
          schema:
            $ref: '#/definitions/ErrorResponse'
          examples:
            application/json:
              {
                "code": "UAR-10003",
                "message": "not acceptable",
                "description": "invalid error code : 1234-2345-12345-123456",
                "traceId": "23456fghj678vb78"
              }
        500:
          description: Server Error.
          schema:
            $ref: '#/definitions/ErrorResponse'
          examples:
            application/json:
              {
                "code": "UAR-15001",
                "message": "Internal Error",
                "description": "Internal Error",
                "traceId": "23456fghj678vb78"
              }

  /recovery/password/confirm:
    post:
      tags:
        - Password Recovery
      summary: |
        Confirm password recovery
      operationId: confirmRecovery
      description: |
        - This API is used to validate the __confirmationCode__ given at password recovery.
        - Use the returned __reset code__ with the __password reset API__ to reset the password.
        - The API will return the next API call.

      # API parameters:
      parameters:
        -
          name: ConfirmRequest
          in: body
          description: |
            - Request to confirm the password recovery.
            - `confirmationCode` is `REQUIRED`.
          required: true
          schema:
            $ref: '#/definitions/ConfirmRequest'

      # API responses
      responses:
        200:
          description: |
            - Password reset confirmed.
            - `resetCode` is returned.
          schema:
            $ref: '#/definitions/ResetCodeResponse'
          examples:
            application/json:
              {
                "resetCode": "2806aed9-fe7c-4b47-a91f-0aa897fac9a2",
                "links": [
                {
                  "rel": "next",
                  "href": "/t/carbon.super/api/identity/recovery/v1/password/reset",
                  "type": "POST"
                }
                ]
              }
        400:
          description: Bad Request. Request cannot be processed by the server.
          schema:
            $ref: '#/definitions/ErrorResponse'
          examples:
            application/json:
              {
                "code": "PWR-10001",
                "message": "bad_request",
                "description": "bad request",
                "traceId": "23456fghj678vb78"
              }
        404:
          description: Confirmation code is not found.
          schema:
            $ref: '#/definitions/ErrorResponse'
          examples:
            application/json:
              {
                "code": "PWR-10001",
                "message": "not_found",
                "description": "recovery code not found",
                "traceId": "23456fghj678vb78"
              }
        406:
          description: |
            Confirmation code given in the request is not valid or expired.
          schema:
            $ref: '#/definitions/ErrorResponse'
          examples:
            application/json:
              {
                "code": "PWR-10001",
                "message": "not acceptable",
                "description": "invalid error code : 1234-2345-12345-123456",
                "traceId": "23456fghj678vb78"
              }
        500:
          description: Server Error.
          schema:
            $ref: '#/definitions/ErrorResponse'
          examples:
            application/json:
              {
                "code": "PWR-15001",
                "message": "Internal Error",
                "description": "Internal Error",
                "traceId": "23456fghj678vb78"
              }

  /recovery/password/reset:
    post:
      tags:
        - Password Recovery
      summary: |
        Reset password
      operationId: resetPassword
      description: |
        This API is used to reset the password of the user who matches the resetCode given by the confirmation API.

      # API parameters:
      parameters:
        -
          name: ResetRequest
          in: body
          description: |
            - Request to reset the password.
            - `resetCode` and `password` are required.
          required: true
          schema:
            $ref: '#/definitions/ResetRequest'

      # API responses
      responses:
        200:
          description: Successful password reset.
          schema:
            $ref: '#/definitions/PasswordResetResponse'
          examples:
            application/json:
              {
                "code": "PWR-02005",
                "message": "Successful password reset"
              }
        400:
          description: Bad Request. Request cannot be processed by the server.
          schema:
            $ref: '#/definitions/ErrorResponse'
          examples:
            application/json:
              {
                "code": "PWR-10001",
                "message": "bad_request",
                "description": "bad request",
                "traceId": "23456fghj678vb78"
              }
        404:
          description: Reset code is not found.
          schema:
            $ref: '#/definitions/ErrorResponse'
          examples:
            application/json:
              {
                "code": "PWR-10001",
                "message": "not_found",
                "description": "recovery code not found",
                "traceId": "23456fghj678vb78"
              }
        406:
          description: Reset code given in the request is not valid or expired.
          schema:
            $ref: '#/definitions/ErrorResponse'
          examples:
            application/json:
              {
                "code": "PWR-10001",
                "message": "not acceptable",
                "description": "invalid error code : 1234-2345-12345-123456",
                "traceId": "23456fghj678vb78"
              }
        412:
          description: Password policy violation.
          schema:
            $ref: '#/definitions/RetryErrorResponse'
          examples:
            application/json:
              {
                "code": "PWR-10001",
                "message": "bad_request",
                "description": "password policy violation",
                "traceId": "23456fghj678vb78"
              }
        500:
          description: Server Error.
          schema:
            $ref: '#/definitions/ErrorResponse'
          examples:
            application/json:
              {
                "code": "PWR-15001",
                "message": "Internal Error",
                "description": "Internal Error",
                "traceId": "23456fghj678vb78"
              }

definitions:
  #-----------------------------------------------------
  # InitRequest  object
  #-----------------------------------------------------
  InitRequest:
    type: object
    description: Request to initate an account recovery
    properties:
      claims:
        type: array
        description: User claims to identify the user as UserClaim objects
        items:
          $ref: '#/definitions/UserClaim'
      properties:
        type: array
        description: (OPTIONAL) Additional META properties
        items:
          $ref: '#/definitions/Property'
    required:
      - claims

  #-----------------------------------------------------
  # RecoveryRequest  object
  #-----------------------------------------------------
  RecoveryRequest:
    type: object
    description: Request to start the recovery for the user who matches the recovery code via the given channelID
    properties:
      recoveryCode:
        type: string
        description: Recovery code for the user
        example: "1234-5678-2455-3433"
      channelId:
        type: string
        description: Id of the notification channel that user preferrs to get recovery notifications.
        example: "1"
      properties:
        type: array
        description: (OPTIONAL) Additional META properties
        items:
          $ref: '#/definitions/Property'
    required:
      - recoveryCode
      - channelId

  #-----------------------------------------------------
  # ResendConfirmationRequest  object
  #-----------------------------------------------------
  ResendConfirmationRequest:
    type: object
    description: Request to resend the confirmation code in password recovery
    properties:
      resendCode:
        type: string
        description: Resend code returned by the password recovery API
        example: "1234-2ws34-1234"
      properties:
        type: array
        description: (OPTIONAL) Additional META properties
        items:
          $ref: '#/definitions/Property'

  #-----------------------------------------------------
  # ConfirmRequest  object
  #-----------------------------------------------------
  ConfirmRequest:
    type: object
    description: Request to confirm password recovery
    properties:
      confirmationCode:
        type: string
        description: Confirmation code given to the user
        example: "1234-2ws34-12345"
      properties:
        type: array
        description: (OPTIONAL) Additional META properties
        items:
          $ref: '#/definitions/Property'

  #-----------------------------------------------------
  # ResetRequest object
  #-----------------------------------------------------
  ResetRequest:
    type: object
    description: Object to reset the password of a user
    properties:
      resetCode:
        type: string
        description: resetCode given by the confim API
      password:
        type: string
        description: New password given by the user
      properties:
        type: array
        description: (OPTIONAL) Additional META properties
        items:
          $ref: '#/definitions/Property'

  #-----------------------------------------------------
  # UsernameRecoveryInitResponse  object
  #-----------------------------------------------------
  UsernameRecoveryInitResponse:
    type: array
    description: Response with the username recovery information
    items:
      $ref: '#/definitions/AccountRecoveryType'


  #-----------------------------------------------------
  # PasswordRecoveryInitResponse  object
  #-----------------------------------------------------
  PasswordRecoveryInitResponse:
    type: array
    description: Response with the Password Recovery information
    items:
      $ref: '#/definitions/AccountRecoveryType'

  #-----------------------------------------------------
  # PasswordRecoveryInternalNotifyResponse object
  #-----------------------------------------------------
  PasswordRecoveryInternalNotifyResponse:
    type: object
    properties:
      code:
        type: string
        description: Success status code
        example: "PWR-02002"
      message:
        type: string
        description: Success status message
        example: "successful_request"
      notificationChannel:
        type: string
        description: Channel that is used to send recovery information
        example: "EMAIL"
      resendCode:
        type: string
        description: Code to resend the confirmation code to the user via user user selected channel
        example: "1234-123456-12345-12345"
      links:
        type: array
        description: Contains available api calls
        items:
          $ref: '#/definitions/APICall'
    required:
      - code
      - message
      - notificationChannel

  #-----------------------------------------------------
  # PasswordRecoveryExternalNotifyResponse object
  #-----------------------------------------------------
  PasswordRecoveryExternalNotifyResponse:
    type: object
    properties:
      code:
        type: string
        description: Success status code
        example: "PWR-02002"
      message:
        type: string
        description: Success status message
        example: "successful_request"
      notificationChannel:
        type: string
        description: Channel that is used to send recovery information
        example: "EXTERNAL"
      confirmationCode:
        type: string
        description: |
          - Confirmation code for password recovery when the notifications are externally managed.
          - The confirmation code will be returned only if the notification channel is _EXTERNAL_. Use this code with password confirm API to get a password reset code.
        example: "12345-45678-6789098-8765"
      links:
        type: array
        description: Contains available api calls
        items:
          $ref: '#/definitions/APICall'
    required:
      - code
      - message
      - notificationChannel
      - confirmationCode

  #-----------------------------------------------------
  # UsernameRecoveryInternalNotifyResponse object
  #-----------------------------------------------------
  UsernameRecoveryInternalNotifyResponse:
    type: object
    description: API response for successful username recovery
    properties:
      code:
        type: string
        description: Success status code
        example: "UNR-02001"
      message:
        type: string
        description: Success status message
        example: "successful_request"
      notificationChannel:
        type: string
        description: Channel which the recovery information is sent to the user
        example: "EMAIL"
    required:
      - code
      - message
      - notificationChannel

  #-----------------------------------------------------
  # UsernameRecoveryExternalNotifyResponse object
  #-----------------------------------------------------
  UsernameRecoveryExternalNotifyResponse:
    type: object
    description: API response for successful username recovery
    properties:
      code:
        type: string
        description: Success status code
        example: "UNR-02001"
      message:
        type: string
        description: Success status message
        example: "successful_request"
      notificationChannel:
        type: string
        description: Channel which the recovery information is sent to the user
        example: "EXTERNAL"
      username:
        type: string
        example: "user1"
        description: |
          - Username of the user
          - Username will be returned _ONLY IF_ the notification channel is `EXTERNAL`
    required:
      - code
      - message
      - notificationChannel
      - username

  #-----------------------------------------------------
  # ResetCodeResponse object
  #-----------------------------------------------------
  ResetCodeResponse:
    properties:
      resetCode:
        type: string
        description: Password reset code to reset the password
        example: '1234-55678-5668-2345'
      links:
        type: array
        description: Contains available api calls
        items:
          $ref: '#/definitions/APICall'

  #-----------------------------------------------------
  # PasswordResetResponse object
  #-----------------------------------------------------
  PasswordResetResponse:
    type: object
    description: API response for a successful password reset
    properties:
      code:
        type: string
        description: Operation code
        example: "PWR-02001"
      message:
        type: string
        description: Message regarding the operation.
        example: "successful_request"

  #-----------------------------------------------------
  # ResendConfirmationCodeResponse object
  #-----------------------------------------------------
  ResendConfirmationCodeResponse:
    type: object
    description: Object encapsulate the details regarding resend confirmation code
    properties:
      code:
        type: string
        description: Success status code
        example: "PWR-02002"
      message:
        type: string
        description: Success status message
        example: "successful_request"
      notificationChannel:
        type: string
        description: Channel that is used to send recovery information
        example: "EMAIL"
      resendCode:
        type: string
        description: Resend code to resend the confirmation code
        example: "1234-12345-234-123456"
      links:
        type: array
        description: Contains available api calls
        items:
          $ref: '#/definitions/APICall'

  #-----------------------------------------------------
  # RetryErrorResponse object
  #-----------------------------------------------------
  RetryErrorResponse:
    type: object
    properties:
      code:
        type: string
        description: Error code corresponding to the error
        example: "PWR-10004"
      message:
        type: string
        description: Error message
        example: "Retry"
      description:
        type: string
        description: Error description
        example: "Password policy violation"
      resetCode:
        type: string
        description: Password reset code used in the request
        example: "1234-34567-3456-2345678"
      links:
        type: array
        description: Contains available api calls
        items:
          $ref: '#/definitions/APICall'

  #-----------------------------------------------------
  # ErrorResponse  object
  #-----------------------------------------------------
  ErrorResponse:
    type: object
    properties:
      code:
        type: string
        description: Error code corresponding to the error
        example: "UAR-10001"
      message:
        type: string
        description: Error message
        example: "invalid_request"
      description:
        type: string
        description: Description about the error
        example: "Invalid claim uri"
      traceId:
        type: string
        description: "Some Correlation for Error Instance"
        example: "2345dfgh678h789bhjk"
  #-----------------------------------------------------
  # AccountRecoveryType object
  #-----------------------------------------------------
  AccountRecoveryType:
    type: object
    description: Object that encapsulates details of the account recovery channel
    properties:
      mode:
        type: string
        example: recoverWithNotifications
      channelInfo:
        $ref: '#/definitions/RecoveryChannelInformation'
      links:
        type: array
        description: Contains available api calls
        items:
          $ref: '#/definitions/APICall'

  #-----------------------------------------------------
  # RecoveryChannelInformation object
  #-----------------------------------------------------
  RecoveryChannelInformation:
    description: Response with the recovery ID and the available recovery channels
    properties:
      recoveryCode:
        type: string
        description: Code to recovery the user account
        example: '1234-55678-5668-2345'
      channels:
        type: array
        description: Availabel recovery channels for the user
        items:
          $ref: '#/definitions/RecoveryChannel'

  #-----------------------------------------------------
  # RecoveryChannel object
  #-----------------------------------------------------
  RecoveryChannel:
    type: object
    description: Object with notification channel attributes
    properties:
      id:
        type: string
        description: Id given to the channel
        example: "1"
      type:
        type: string
        description: Type of the chanel
        example: "EMAIL"
      value:
        type: string
        description: Masked channel value
        example: "wso2***********.com"
      preferred:
        type: boolean
        description: Whether the channel is a user preferred channel
        example: true

  #-----------------------------------------------------
  # UserClaim  object
  #-----------------------------------------------------
  UserClaim:
    type: object
    description: Object that holds a user claim and the corresponding value
    properties:
      uri:
        type: string
        description: Claim uri
        example: "http://wso2.org/claims/givenname"
      value:
        type: string
        description: Value for the claim
        example: "user1"

  #-----------------------------------------------------
  # Property  object
  #-----------------------------------------------------
  Property:
    type: object
    description: object that holds a property as a key, value pair
    properties:
      key:
        type: string
        description: Unique identifier as the key of the peroperty
        example: "key"
      value:
        type: string
        description: Value of the property
        example: "value"

  #-----------------------------------------------------
  # APICall object
  #-----------------------------------------------------
  APICall:
    type: object
    description: Object that holds next API call details
    properties:
      rel:
        type: string
        description: Next API call
        example: "next"
      href:
        type: string
        description: Next API url
        example: "/api/identity/recovery/v1/recovery"
      type:
        type: string
        description: HTTP method type
        example: "POST"
